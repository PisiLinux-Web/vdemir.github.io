---
layout: post
title: Dnsmasq
date:   2018-06-16 13:52:00
tags:   Dnsmasq
comments: False
---

{{ page.title }}
================
{% include CSS.html %}

<p class="meta">16 Ocak 2018 - Türkiye</p>

How to speed up the internet through caching DNS on Linux machines with Dnsmasq.
-------------

Dnsmasq is a lightweight DHCP and DNS caching nameserver. Unlike BIND, dnsmasq is incredibly simple to get up and running. The benefits of adding this will be quite obvious (like your DNS queries getting dramatically faster).

I want to walk you through the steps of installing and configuring dnsmasq.

## Installation

The first thing you must do is install dnsmasq.

<div class='pull-right alert alert-warning' style="margin: 15px; text-align: center;">
  <img src="/images/DiagramaDNS01.png" alt="programs" class="img-responsive" width="470px" height="313px"/>
  <p><small>DNS &bull; Browsers.</small></p>
</div>

Once that command completes, the software is installed and ready to be configured.

## Configuration
There are three files that must be configured. The first is /etc/dnsmasq.conf. Open that file in your text editor of choice and look for the line:

#listen-address=
Change the above line to:

~~~
listen-address=127.0.0.1
~~~

Optionally, you could increase the cache size for dnsmasq. Look for the line #cache-size=150. Remove the # and change the 150 to 1000 or whatever size you might need (there is a hard-limit of 10000).

Save and close the file.
<div class='pull-right alert alert-warning' style="margin: 15px; text-align: center;">
  <img src="/images/Servidor-DNS-con-dnsmasq.png" alt="programs" class="img-responsive" width="569px" height="325px"/>
  <p><small>Dnsmsaq &bull; Dnsmasq.</small></p>
</div>
Next open up the file /etc/dhcp/dhclient.conf. Look for the line #supersede domain-name "fugue.com home.vix.com"; and make sure the following section looks exactly like this:

prepend domain-name-servers 127.0.0.1;
​request subnet-mask, broadcast-address, time-offset, routers, domain-name, domain-name-servers, host-name, netbios-name-servers, netbios-scope;
NOTE: From request to netbios-scope is all one line.

Save and close that file.

Finally, open up your /etc/resolv.conf file and make sure that it includes (at least) the line:

nameserver 127.0.0.1
Restart the dnsmasq service with the command:

## Testing the improvements

Testing dnsmasq is quite simple. 

